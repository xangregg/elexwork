Names Default To Here( 1 );// Once the results have passed validation, put them into a shareable form:// 	county,precinct,office,district,party,candidate,votes// Add party affiliation from http://www.hudsoncountyclerk.org/2016-general-results/workdir = "work";base file name = "20161108__nj__general__hudson__county";dt = Open( workdir || "/" || "all_stacked." || base file name || ".jmp" );dt << save( workdir || "/" || "final." || base file name || ".jmp" );dt << select where( :Calculated > 0 & :precinct2 != "Unassigned SubDistrict" );dt << Delete Rows();dt << select columns( :Ward Count, :Town Count, :Contest Count );dt << Delete Columns();dt << Select columns( :source line, :precinct, :Ward, :Town, :Calculated, :total, :turnout );dt << Delete Columns();:precinct 2 << set name( "precinct" );:contest << set name( "office" );:choice << set name( "candidate" );:count << set name( "votes" );For Each Row( :candidate = Match( :candidate, "registered", "Registered Voters", "ballots", "Ballots Cast", :candidate ) );dt << New Column( "county", "Character" );For Each Row( :county = "Hudson" );dt << select columns( :county );dt << Move Selected Columns( to first );dt << select columns( :precinct );dt << Move Selected Columns( after( 1 ) );dt << New Column( "district", "Character" );dt << select columns( :district );dt << Move Selected Columns( after( 3 ) );For Each Row(	s = Regex( :office, "(\d+)th", "\1" );	If( Is Missing( s ), s = "" );	:district = s;);dt << New Column( "party", "Character" );dt << select columns( :party );dt << Move Selected Columns( after( 4 ) );For Each Row(	:party = Match( :candidate, 		"Clinton/Kaine", "Democratic",		"Trump/Pence", "Republican",		"La Riva/Puryear", "Socialist Workers",		"Stein/Baraka", "Green",		"Johnson/Weld", "Libertarian",		"Kennedy/Hart", "Socialist Workers",		"Castle/Bradley", "Constitution",		"De La Fuente/Steinberg", "American Delta",		"Moorehead/Lily", "Workers World", 		//"House of Representatives 8th District",		"Albio Sires", "Democratic",		"Agha Khan", "Republican",		"Pablo Olivera", "",		"Dan Delaney", "Libertarian", 		//"House of Representatives 9th District",		"Bill Pascrell Jr.", "Democratic",		"Hector L. Castillo", "Republican",		"Jeff Boss", "",		"Diego Rivera", "Libertarian", 		//"House of Representatives 10th District",		"Donald M. Payne Jr.", "Democratic",		"David H. Pinckney", "Republican",		"Joanne Miller", "",		"Aaron Walter Fraser", "", 		//"County Sheriff",		"Frank X. Schillari", "Democratic",		"Mark Borchert", "Republican", 		//"County Register",		"Diane Coleman", "Democratic",		"Omar Salgado", "Republican", 		//"East Newark Council At Large",		"Charles F. Tighe", "Democratic",		"Jose A. Silva", "Democratic", 		//"Guttenberg Council - Unexpired Term",		"Wayne D. Zitt Jr.", "Democratic", 		//"Harrison Ward 2 Council - Unexpired Term",		"Eleanor Villalta", "Democratic", 		//"Jersey City Ward B Council - Unexpired Term",		"Chris L. Gadsden", "",		"John J. Hallanan III", "",		"Lekendrick Shaw", "", 			""	));dt << save as( "20161108__nj__general__hudson__precinct.csv" );